GOF ç»å…¸è®¾è®¡æ¨¡å¼ï¼ˆä»£ç å±‚çº§ï¼‰

Factoryï¼ˆå·¥å‚ï¼‰

Observerï¼ˆè§‚å¯Ÿè€…ï¼‰

Singletonï¼ˆå•ä¾‹ï¼‰

é™¤äº†å¸¸è§çš„ GoF æ¨¡å¼æ¯”å¦‚,æ¶æ„æ¨¡å¼ï¼ˆç³»ç»Ÿ/ä¸šåŠ¡å±‚çº§ï¼‰ ï¼ˆArchitectural Patterns

Repository + Unit of Workï¼ˆä»“å‚¨ + å·¥ä½œå•å…ƒï¼‰

DDDï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼‰

Event-Driven / äº‹ä»¶é©±åŠ¨æ¶æ„



## ğŸ”¹ ä¸€ã€åˆ›å»ºå‹ï¼ˆCreationalï¼‰æ¨¡å¼

### 1. Singleton å•ä¾‹æ¨¡å¼

**åœºæ™¯**ï¼šå…¨å±€åªéœ€è¦ä¸€ä¸ªå®ä¾‹ï¼Œæ¯”å¦‚æ—¥å¿—ã€é…ç½®ã€ç¼“å­˜ç®¡ç†ç­‰ã€‚

```csharp
public sealed class Logger
{
    private static readonly Lazy<Logger> _instance =
        new Lazy<Logger>(() => new Logger());

    public static Logger Instance => _instance.Value;

    private Logger() { }

    public void Log(string message)
    {
        Console.WriteLine(message);
    }
}
```

* `sealed` é˜²ç»§æ‰¿
* `Lazy<T>` çº¿ç¨‹å®‰å…¨ + å»¶è¿ŸåŠ è½½
* .NET é¢è¯•ç»å¸¸é—® â€œçº¿ç¨‹å®‰å…¨å•ä¾‹æ€ä¹ˆå†™ï¼Ÿâ€

---

### 2. Factory / Factory Method å·¥å‚æ¨¡å¼

**åœºæ™¯**ï¼šæ ¹æ®æ¡ä»¶åˆ›å»ºä¸åŒå¯¹è±¡ï¼Œéšè— `new` ç»†èŠ‚ã€‚

```csharp
public interface INotification
{
    void Send(string msg);
}

public class EmailNotification : INotification
{
    public void Send(string msg) => Console.WriteLine("Email: " + msg);
}

public class SmsNotification : INotification
{
    public void Send(string msg) => Console.WriteLine("SMS: " + msg);
}

public static class NotificationFactory
{
    public static INotification Create(string type)
    {
        return type switch
        {
            "email" => new EmailNotification(),
            "sms"   => new SmsNotification(),
            _       => throw new NotSupportedException()
        };
    }
}
```

---

## ğŸ”¹ äºŒã€ç»“æ„å‹ï¼ˆStructuralï¼‰æ¨¡å¼

### 3. Adapter é€‚é…å™¨æ¨¡å¼

**åœºæ™¯**ï¼šè€æ¥å£ / ç¬¬ä¸‰æ–¹åº“çš„æ¥å£ä¸åŒ¹é…ä½ ç°åœ¨çš„æ¥å£å®šä¹‰ï¼Œé€šè¿‡â€œé€‚é…å™¨â€åšä¸€å±‚è½¬æ¢ã€‚

```csharp
// è€æ¥å£
public class LegacyPayment
{
    public void Pay(decimal amount) => Console.WriteLine($"Legacy pay {amount}");
}

// æ–°ç³»ç»Ÿæ¥å£
public interface IPayment
{
    void Process(decimal amount);
}

// é€‚é…å™¨
public class PaymentAdapter : IPayment
{
    private readonly LegacyPayment _legacy;

    public PaymentAdapter(LegacyPayment legacy) => _legacy = legacy;

    public void Process(decimal amount) => _legacy.Pay(amount);
}
```

---

### 4. Decorator è£…é¥°å™¨æ¨¡å¼

**åœºæ™¯**ï¼šåœ¨ä¸ä¿®æ”¹åŸæœ‰ç±»çš„å‰æä¸‹ï¼ŒåŠ¨æ€ç»™å¯¹è±¡â€œå¥—ä¸€å±‚åŠŸèƒ½â€ï¼Œæ¯”å¦‚æ—¥å¿—ã€ç¼“å­˜ã€æƒé™æ ¡éªŒã€‚

```csharp
public interface IService
{
    void DoWork();
}

public class RealService : IService
{
    public void DoWork() => Console.WriteLine("Doing work");
}

public class LoggingServiceDecorator : IService
{
    private readonly IService _inner;

    public LoggingServiceDecorator(IService inner) => _inner = inner;

    public void DoWork()
    {
        Console.WriteLine("Before Work");
        _inner.DoWork();
        Console.WriteLine("After Work");
    }
}
```

---

## ğŸ”¹ ä¸‰ã€è¡Œä¸ºå‹ï¼ˆBehavioralï¼‰æ¨¡å¼

### 5. Strategy ç­–ç•¥æ¨¡å¼

**åœºæ™¯**ï¼šå°è£…ä¸€ç»„ç®—æ³•ï¼ˆæ¯”å¦‚ä¸åŒè®¡ä»·æ–¹å¼ã€ä¸åŒæ’åºæ–¹å¼ï¼‰ï¼Œè¿è¡Œæ—¶å¯ä»¥äº’æ¢ã€‚

```csharp
public interface IDiscountStrategy
{
    decimal ApplyDiscount(decimal price);
}

public class NoDiscount : IDiscountStrategy
{
    public decimal ApplyDiscount(decimal price) => price;
}

public class PercentageDiscount : IDiscountStrategy
{
    private readonly decimal _rate;
    public PercentageDiscount(decimal rate) => _rate = rate;

    public decimal ApplyDiscount(decimal price) => price * (1 - _rate);
}

public class PriceCalculator
{
    private readonly IDiscountStrategy _strategy;
    public PriceCalculator(IDiscountStrategy strategy) => _strategy = strategy;

    public decimal Calculate(decimal price) => _strategy.ApplyDiscount(price);
}
```

---

### 6. Observer è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆ.NET é‡Œå¸¸è§ï¼‰

**åœºæ™¯**ï¼šä¸€ä¸ªå¯¹è±¡çŠ¶æ€å˜æ›´ï¼Œé€šçŸ¥å¤šä¸ªè®¢é˜…è€…ï¼Œæ¯”å¦‚äº‹ä»¶ã€æ¶ˆæ¯é€šçŸ¥ã€‚

æœ€å¸¸è§å°±æ˜¯ C# çš„äº‹ä»¶ / å§”æ‰˜æœ¬èº«ï¼š

```csharp
public class Publisher
{
    public event EventHandler<string>? MessagePublished;

    public void Publish(string message)
    {
        MessagePublished?.Invoke(this, message);
    }
}

public class Subscriber
{
    public void OnMessage(object? sender, string msg)
    {
        Console.WriteLine("Received: " + msg);
    }
}
```

---

## ğŸ”¹ å››ã€.NET é¡¹ç›®é‡Œç‰¹åˆ«å¸¸è§çš„â€œæ¶æ„ç±»â€æ¨¡å¼

è¿™äº›ä¸ä¸€å®šå‡ºç°åœ¨ GoF 23 ç§è®¾è®¡æ¨¡å¼é‡Œï¼Œä½†åœ¨ C#/.NET é¡¹ç›®éå¸¸ç»å…¸ï¼Œé¢è¯•ç»å¸¸é—®ã€‚

### 7. Dependency Injection ä¾èµ–æ³¨å…¥ï¼ˆIoCï¼‰

**åœºæ™¯**ï¼šè§£è€¦å¯¹è±¡ä¹‹é—´ä¾èµ–ï¼Œé€šè¿‡å®¹å™¨ç»Ÿä¸€ç®¡ç†ç”Ÿå‘½å‘¨æœŸã€‚

ASP.NET Core åŸç”Ÿæ”¯æŒï¼š

```csharp
// æ³¨å†Œ
builder.Services.AddScoped<IUserService, UserService>();

// æ„é€ å‡½æ•°æ³¨å…¥
public class UserController : ControllerBase
{
    private readonly IUserService _userService;
    public UserController(IUserService userService) => _userService = userService;
}
```

> é¢è¯•å¸¸é—®ï¼š
> â€œè¯´ä¸€ä¸‹ä¾èµ–æ³¨å…¥ / IoC çš„ä½œç”¨ï¼Ÿä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿâ€

---

### 8. Repository + Unit of Work ä»“å‚¨ + å·¥ä½œå•å…ƒ

**åœºæ™¯**ï¼šé¢†åŸŸå±‚/åº”ç”¨å±‚å±è”½ EF Core / æ•°æ®åº“ç»†èŠ‚ã€‚

```csharp
public interface IUserRepository
{
    Task<User?> GetByIdAsync(int id);
    Task AddAsync(User user);
}

public interface IUnitOfWork
{
    Task<int> SaveChangesAsync();
}
```

åœ¨ ASP.NET Core + EF Core é¡¹ç›®ä¸­éå¸¸å¸¸è§ã€‚

---

### 9. MVC / MVVM

* **MVC**ï¼šASP.NET Core MVC / Web API
* **MVVM**ï¼šWPF / MAUI / Blazorï¼ˆæœ‰ç‚¹ç±»ä¼¼ï¼‰

è¿™ä¸¤ä¸ªæ˜¯å‰åç«¯æ¶æ„æ¨¡å¼ï¼Œä¸å…·ä½“å±•å¼€ï¼Œä½ è‚¯å®šè§è¿‡ Controller / ViewModel é‚£å¥—ã€‚

---

## ğŸ”š é¢è¯•/ç®€å†ä¸Šå¯ä»¥è¿™æ ·æ€»ç»“ï¼ˆC#.NET å¸¸è§è®¾è®¡æ¨¡å¼ï¼‰


> åœ¨ C#/.NET é¡¹ç›®ä¸­å®é™…ä½¿ç”¨è¿‡å¤šç§è®¾è®¡æ¨¡å¼ï¼ŒåŒ…æ‹¬
> Singletonã€Factoryã€Strategyã€Observerã€Decorator ç­‰ç»å…¸ GoF æ¨¡å¼ï¼Œ
> ä»¥åŠå¸¸è§çš„ Repositoryã€Unit of Workã€Dependency Injectionã€MVC/MVVM ç­‰æ¶æ„æ¨¡å¼ï¼Œ
> ç”¨äºæå‡ä»£ç çš„å¯ç»´æŠ¤æ€§ã€å¯æµ‹è¯•æ€§å’Œæ‰©å±•æ€§ã€‚


